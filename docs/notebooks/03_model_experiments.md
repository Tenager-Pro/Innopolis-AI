# Документация: Продвинутые эксперименты с моделями и оптимизация гиперпараметров

## Обзор
Модуль для проведения расширенных экспериментов с моделями машинного обучения, включая оптимизацию гиперпараметров, сравнение ансамблевых алгоритмов и анализ важности признаков для задачи прогнозирования оттока клиентов.

## Назначение
Повышение качества предсказаний за счет:
1. Тестирования продвинутых алгоритмов машинного обучения
2. Систематической оптимизации гиперпараметров
3. Сравнения производительности различных подходов
4. Анализа устойчивости и калибровки моделей

## Действия

1. Инициализация и загрузка данных
Загрузка подготовленных данных

2. Определение продвинутых моделей
    Поддерживаемые алгоритмы:
        Random Forest (Случайный лес)
        Gradient Boosting (Градиентный бустинг)
        XGBoost (Экстремальный градиентный бустинг)
        LightGBM (Легкий градиентный бустинг)
        SVM (Метод опорных векторов)
4. Метрики оценки
    Основные метрики:
        Accuracy: Общая точность классификации
        AUC-ROC: Площадь под ROC-кривой (способность различать классы)
        Average Precision: Средняя точность (важна при несбалансированных данных)

    Дополнительный анализ:
        Распределение оценок кросс-валидации
        Стабильность гиперпараметров
        Доверительные интервалы

5. Анализ важности признаков
    Поддерживаемые модели:
        Tree-based модели (Random Forest, Gradient Boosting, XGBoost, LightGBM)

    Аналитические подходы:
        Индивидуальная важность признаков для каждой модели
        Совокупная важность (средняя по всем моделям)
        Топ-10 признаков для каждой модели

    Визуализация:
        6 графиков в сетке 2×3
        Отдельные графики для каждой модели
        Совокупный график средней важности

6. Калибровка моделей и анализ устойчивости
    Калибровочные кривые:
        Сравнение предсказанных вероятностей с фактическими
        Оценка калиброванности моделей
        Идеальная калибровка: диагональная линия

    Анализ устойчивости:
        Boxplot распределения CV-оценок
        Сравнение стабильности моделей
        Выявление моделей с высокой дисперсией

7. Статистический анализ
    Доверительные интервалы:
        Используемые тесты:
            t-распределение для малых выборок
            95% доверительные интервалы
            Оценка статистической значимости различий

8. Сохранение результатов
    Сохраняемые артефакты:
        Лучшая модель: .pkl файл с сериализованной моделью
        Результаты экспериментов: JSON файл с метаинформацией
        Сводные таблицы: DataFrame с сравнением моделей